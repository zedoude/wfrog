

# Introduction #

Consumer weather stations become wide-spread and in this area the bundled software is often proprietary, limited to an operating system and provides poor support for integrating with other software.

On an other hand, independent software providers work on weather software gaining popularity because they pay attention to what the users need (other features, other OS, open-source license, ...). However, each of them need to develop and test their own implementation of weather station drivers or integrate an existing one with the effort of adapting it to their model.

This document introduces WESTEP, an XML language and streaming rules for events that a weather station typically issues. This allows for software providers to integrate their software with a wider range of weather station models, provided it exists a WESTEP driver for them. A WESTEP driver is a piece of software receiving data from the weather station and transforming it to XML events.

Note that is protocol is NOT dedicated to upload current weather conditions to a website like weatherunderground.com. The purpose is to allow for building lightweight drivers that transform and send the sensor events as soon as they arrive from the station, i.e. separately.

Station vendors also have benefits in providing WESTEP drivers. They open their users to more choice and acceptance of their products.

# Principles #

WESTEP (WEather STation Event Protocol) relies on two layers:
  * **Format**. This is the XML language itself.
  * **Transport**. This is how the XML messages are exchanged accross software components.

We call 'producer' the process sending the event. It is usually a driver, but can also be an intermediate (routing, transformation, ...).

We call 'consumer' the process receiving the event. It is usually a weather software like a datalogger, but can also be an intermediate (routing, transformation, ...).

# Format #

This section fully describes the XML format for the events.

## XML Schema ##

  * [Documentation](http://www.windmaster.ch/westep/doc/http___www.westep.org_2010_westep/index.html) generated by xsddoc.
  * [westep.xsd](http://wfrog.googlecode.com/svn/trunk/xsd/westep.xsd), the schema itself.


## Example ##

The following XML messages are valid WESTEP events:

```
    <temp>
        <station>3</station>
        <sensor>2</sensor>
        <value>23.0</value>
    </temp>

    <temp>
        <value>24.2</value>
    </temp>

    <press>
        <value>1030</value>
        <code>QNH</code>
    </press>

    <press>
        <value>1026.2</value>
    </press>

    <hum>
        <value>65</value>
    </hum>

    <rain>
        <rate>0.0</rate>
        <total>544.0</total>
    </rain>

    <wind>
        <mean>
            <speed>3.1</speed>
            <dir>22.5</dir>
        </mean>
    </wind>

    <wind>
        <mean>
            <speed>3.1</speed>
            <dir>31.6</dir>
        </mean>
        <gust>
            <speed>4.5</speed>
            <dir>22.5</dir>
        </gust>
    </wind>

    <uv>
        <value>1</value>
    </uv>
```

## Extensions ##

WESTEP supports proprietary extensions on the form of additional event types and additional elements the standard event messages after the standard elements. Extension elements must appear in a distinct namespace.
# Transport #

In the current version of the specification, the following transports are specified:

  * **STDIO Transport**
  * **HTTP Transport**

## STDIO Transport ##

With this transport, the producer and consumer processes usually run on the same machine and communicate through OS pipes. The producers issues a stream of XML messages terminated by an empty line on its standard output. The consumer receives this stream on its standard input.

The following must be observed:
  * The XML messages MUST not contain empty lines. This is a restriction over XML.
  * The definition 'empty line' is OS-specific.

## HTTP Transport ##

With this transport, the event producer process performs a HTTP POST request on the event consumer process. The payload of the POST request is the XML message. For optimizing resource consumption, supporting HTTP 1.1 keep-alive is recommended.

# Compliance #

Any product vendor or software provider wanting to use the WESTEP name to show their compliance to the protocol must announce it to the email address "compliance AT westep DOT org".

The compliance is then shown by specifying the supported protocol versions and transports. E.g. **WESTEP 1.0, 1.1 STDIO, HTTP**

# Reference Implementation #

The [wfrog](http://wfrog.org) project provides the reference implementation of WESTEP. It is developed in python.